var se=Object.create;var P=Object.defineProperty;var oe=Object.getOwnPropertyDescriptor;var te=Object.getOwnPropertyNames;var ae=Object.getPrototypeOf,ne=Object.prototype.hasOwnProperty;var Te=(r,s)=>{for(var e in s)P(r,e,{get:s[e],enumerable:!0})},z=(r,s,e,x)=>{if(s&&typeof s=="object"||typeof s=="function")for(let t of te(s))!ne.call(r,t)&&t!==e&&P(r,t,{get:()=>s[t],enumerable:!(x=oe(s,t))||x.enumerable});return r};var de=(r,s,e)=>(e=r!=null?se(ae(r)):{},z(s||!r||!r.__esModule?P(e,"default",{value:r,enumerable:!0}):e,r)),pe=r=>z(P({},"__esModule",{value:!0}),r);var ie={};Te(ie,{useForm:()=>V,useModalForm:()=>X,useStepsForm:()=>J});module.exports=pe(ie);var W=require("react"),I=require("react-hook-form"),Q=require("@refinedev/core"),V=({refineCoreProps:r,warnWhenUnsavedChanges:s,...e}={})=>{let{warnWhenUnsavedChanges:x,setWarnWhen:t}=(0,Q.useWarnAboutChange)(),C=s??x,E=(0,Q.useForm)({...r}),{queryResult:m,onFinish:f,formLoading:T}=E,y=(0,I.useForm)({...e}),{watch:u,setValue:a,getValues:D,handleSubmit:o}=y;(0,W.useEffect)(()=>{var R;let d=(R=m==null?void 0:m.data)==null?void 0:R.data;if(!d)return;let c=Object.keys(D());Object.entries(d).forEach(([v,k])=>{let b=v;c.includes(b)&&a(b,k)})},[m==null?void 0:m.data,a,D]),(0,W.useEffect)(()=>{let d=u((c,{type:R})=>{R==="change"&&l(c)});return()=>d.unsubscribe()},[u]);let l=d=>(C&&t(!0),d),n=(d,c)=>async R=>(t(!1),o(d,c)(R));return{...y,handleSubmit:n,refineCore:E,saveButtonProps:{disabled:T,onClick:d=>{n(f,()=>!1)(d)}}}};var S=require("react");var J=({stepsProps:r,...s}={})=>{let{defaultStep:e=0,isBackValidate:x=!1}=r??{},[t,C]=(0,S.useState)(e),E=V({...s}),{trigger:m,getValues:f,setValue:T,formState:{dirtyFields:y},refineCore:{queryResult:u}}=E;(0,S.useEffect)(()=>{var n;let o=(n=u==null?void 0:u.data)==null?void 0:n.data;if(!o)return;let l=Object.keys(f());Object.entries(o).forEach(([B,d])=>{let c=B;l.includes(c)&&(y[c]||T(c,d))})},[u==null?void 0:u.data,t,T,f]);let a=o=>{let l=o;o<0&&(l=0),C(l)};return{...E,steps:{currentStep:t,gotoStep:async o=>{if(o===t)return;if(o<t&&!x){a(o);return}await m()&&a(o)}}}};var M=require("react"),i=require("@refinedev/core");var g=de(require("react")),X=({modalProps:r,refineCoreProps:s,syncWithLocation:e,...x}={})=>{var A,G;let[t,C]=g.default.useState(!1),E=(0,i.useTranslate)(),{resource:m,action:f}=s??{},{resource:T,action:y,identifier:u}=(0,i.useResource)(m),a=(0,i.useParsed)(),D=(0,i.useGo)(),o=f??y??"",l=!(typeof e=="object"&&(e==null?void 0:e.syncId)===!1),n=typeof e=="object"&&"key"in e?e.key:T&&o&&e?`modal-${u}-${o}`:void 0,{defaultVisible:B=!1,autoSubmitClose:d=!0,autoResetForm:c=!0}=r??{},R=V({refineCoreProps:s,...x}),{reset:v,refineCore:{onFinish:k,id:b,setId:F},saveButtonProps:Z,handleSubmit:_}=R,{visible:U,show:h,close:$}=(0,i.useModal)({defaultVisible:B});g.default.useEffect(()=>{var p,w,j,N;if(t===!1&&n){let H=(w=(p=a==null?void 0:a.params)==null?void 0:p[n])==null?void 0:w.open;if(typeof H=="boolean"?H&&h():typeof H=="string"&&H==="true"&&h(),l){let Y=(N=(j=a==null?void 0:a.params)==null?void 0:j[n])==null?void 0:N.id;Y&&(F==null||F(Y))}C(!0)}},[n,a,l,F]),g.default.useEffect(()=>{var p;t===!0&&(U&&n?D({query:{[n]:{...(p=a==null?void 0:a.params)==null?void 0:p[n],open:!0,...l&&b&&{id:b}}},options:{keepQuery:!0},type:"replace"}):n&&!U&&D({query:{[n]:void 0},options:{keepQuery:!0},type:"replace"}))},[b,U,h,n,l]);let O=async p=>{await k(p),d&&$(),c&&v()},{warnWhen:K,setWarnWhen:q}=(0,i.useWarnAboutChange)(),L=(0,M.useCallback)(()=>{if(K)if(window.confirm(E("warnWhenUnsavedChanges","Are you sure you want to leave? You have unsaved changes.")))q(!1);else return;F==null||F(void 0),$()},[K]),ee=(0,M.useCallback)(p=>{typeof p<"u"&&(F==null||F(p)),(!(o==="edit"||o==="clone")||(typeof p<"u"||typeof b<"u"))&&h()},[b]),re=E(`${u}.titles.${f}`,void 0,`${(0,i.userFriendlyResourceName)(`${f} ${((A=T==null?void 0:T.meta)==null?void 0:A.label)??((G=T==null?void 0:T.options)==null?void 0:G.label)??(T==null?void 0:T.label)??u}`,"singular")}`);return{modal:{submit:O,close:L,show:ee,visible:U,title:re},...R,saveButtonProps:{...Z,onClick:p=>_(O)(p)}}};
//# sourceMappingURL=index.js.map